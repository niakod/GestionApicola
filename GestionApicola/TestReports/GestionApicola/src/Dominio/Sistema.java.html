<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>Sistema.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">JUnitTests (23-nov-2014 18:18:58)</a> &gt; <a href="../../index.html" class="el_group">GestionApicola</a> &gt; <a href="../index.html" class="el_bundle">src</a> &gt; <a href="index.source.html" class="el_package">Dominio</a> &gt; <span class="el_source">Sistema.java</span></div><h1>Sistema.java</h1><pre class="source lang-java linenums">package Dominio;

/**
 * Fachada del sistema. Utiliza Singleton.
 */
<span class="fc" id="L6">public class Sistema {</span>
	/**
	 * Instancia única del sistema.
	 */
<span class="fc" id="L10">	private static Sistema instancia = null;</span>
	/**
	 * Cantidad máxima de puntos que soportará el sistema.
	 */
<span class="fc" id="L14">	private int cantPuntos = 0;</span>
	/**
	 * Array de puntos del sistema.
	 */
	private Punto[] arrPuntos;
	/**
	 * Lista de tramos del sistema.
	 */
	private ListaTramos lstTramos;
	/**
	 * Arbol de apicultores del sistema.
	 */
	private ArbolApicultores treApicultores;

	/**
	 * Constructor de Sistema, no recibe parámetros.
	 */
<span class="fc" id="L31">	private Sistema() {</span>
<span class="fc" id="L32">	}</span>

	/**
	 * Obtiene la instancia del sistema o crea una nueva si la actual es nula.
	 * 
	 * @return Instancia del sistema.
	 */
	public static Sistema getInstancia() {
<span class="fc bfc" id="L40" title="All 2 branches covered.">		if (instancia == null) {</span>
<span class="fc" id="L41">			instancia = new Sistema();</span>
		}
<span class="fc" id="L43">		return instancia;</span>
	}

	/**
	 * Inicializa las estructuras necesarias para representar el sistema
	 * especificado, capaz de albergar como máximo la cantidad de puntos que
	 * recibe como parámetros en el mapa. Los puntos del mapa serán las
	 * ciudades, puntos de extracción, o apiarios.
	 * 
	 * @param vCantPuntos
	 *            Cantidad máxima de puntos soportados por el sistema a crear.
	 * @return Resultado del método.
	 */
	public TipoRetorno inicializarSistema(int vCantPuntos) {
<span class="fc" id="L57">		TipoRetorno tr = new TipoRetorno();</span>
		// Retorno por defecto:
<span class="fc" id="L59">		tr.setTipoError(TipoError.NO_IMPLEMENTADA);</span>
<span class="fc bfc" id="L60" title="All 2 branches covered.">		if (getInstancia().cantPuntos != 0) {</span>
			// Si el sistema ya existe debe ser destruído primero.
<span class="fc" id="L62">			tr.setTipoError(TipoError.ERROR_2);</span>
<span class="fc bfc" id="L63" title="All 2 branches covered.">		} else if (vCantPuntos &lt;= 0) {</span>
			// El número de puntos máximo debe ser mayor a cero.
<span class="fc" id="L65">			tr.setTipoError(TipoError.ERROR_1);</span>
		} else {
<span class="fc" id="L67">			getInstancia().cantPuntos = vCantPuntos; // Asigna la cantidad de</span>
														// puntos.
			// Inicializa el array de puntos con la cantidad máxima de puntos
			// que soportará el sistema:
<span class="fc" id="L71">			getInstancia().arrPuntos = new Punto[vCantPuntos];</span>
			// Inicializa la lista de tramos, con el primer elemento en null:
<span class="fc" id="L73">			getInstancia().lstTramos = new ListaTramos(null);</span>
			// Inicializa el árbol de apicultores, con la raíz en null:
<span class="fc" id="L75">			getInstancia().treApicultores = new ArbolApicultores(null);</span>
<span class="fc" id="L76">			tr.setTipoError(TipoError.OK); // El sistema se inicializa de forma</span>
											// correcta.
		}
<span class="fc" id="L79">		return tr;</span>
	}

	/**
	 * Destruye el sistema de todos sus elementos y estructuras.
	 * 
	 * @return Resultado del método.
	 */
	public TipoRetorno destruirSistema() {
<span class="fc" id="L88">		TipoRetorno tr = new TipoRetorno();</span>
		// Retorno por defecto:
<span class="fc" id="L90">		tr.setTipoError(TipoError.NO_IMPLEMENTADA);</span>
<span class="fc bfc" id="L91" title="All 2 branches covered.">		if (getInstancia().cantPuntos == 0) {</span>
			// No se ha inicializado el sistema.
<span class="fc" id="L93">			tr.setTipoError(TipoError.ERROR_1);</span>
		} else {
			// Setea cantPuntos a 0:
<span class="fc" id="L96">			getInstancia().cantPuntos = 0;</span>
			// Setea los punteros para el array de puntos, lista de tramos y
			// árbol de apicultores a null.
<span class="fc" id="L99">			getInstancia().arrPuntos = null;</span>
<span class="fc" id="L100">			getInstancia().lstTramos = null;</span>
<span class="fc" id="L101">			getInstancia().treApicultores = null;</span>
			// El sistema se destruyo de forma correcta:
<span class="fc" id="L103">			tr.setTipoError(TipoError.OK);</span>
		}
<span class="fc" id="L105">		return tr;</span>
	}

	/**
	 * Registra al apicultor de cédula &quot;cedula&quot; en el sistema.
	 * 
	 * @param cedula
	 *            Cédula del nuevo apicultor.
	 * @param nombre
	 *            Nombre del nuevo apicultor.
	 * @param direccion
	 *            Dirección del nuevo apicultor.
	 * @param email
	 *            Dirección de correo electrónico del nuevo apicultor.
	 * @param celular
	 *            Número de teléfono móvil del nuevo apicultor.
	 * @return Resultado del método.
	 */
	public TipoRetorno registrarApicultor(int cedula, String nombre,
			String direccion, String email, String celular) {
<span class="fc" id="L125">		TipoRetorno ret = new TipoRetorno();</span>
<span class="fc" id="L126">		ret.setTipoError(TipoError.NO_IMPLEMENTADA); // Retorno por defecto.</span>
<span class="fc" id="L127">		Apicultor a = new Apicultor(cedula, nombre, direccion, email, celular);</span>
<span class="fc" id="L128">		boolean booAux = treApicultores.addApicultor(a);</span>
<span class="fc bfc" id="L129" title="All 2 branches covered.">		if (booAux == false) {</span>
<span class="fc" id="L130">			ret.setTipoError(TipoError.ERROR_1);</span>
		} else {
<span class="fc" id="L132">			ret.setTipoError(TipoError.OK);</span>
		}
<span class="fc" id="L134">		return ret;</span>
	}

	/**
	 * Registra la ciudad de nombre nombre y coordenadas coordX, coordY en el
	 * sistema.
	 * 
	 * @param nombre
	 *            Nombre de la ciudad.
	 * @param coordX
	 *            Coordenada en el eje x para la localización de la ciudad.
	 * @param coordY
	 *            Coordenada en el eje y para la localización de la ciudad.
	 * @return Resultado del método.
	 */
	public TipoRetorno registrarCiudad(String nombre, double coordX,
			double coordY) {
<span class="fc" id="L151">		TipoRetorno ret = new TipoRetorno();</span>
<span class="fc" id="L152">		ret.setTipoError(TipoError.NO_IMPLEMENTADA); // Retorno por defecto.</span>
<span class="fc" id="L153">		Ciudad c = new Ciudad(nombre, coordX, coordY);</span>
<span class="fc bfc" id="L154" title="All 2 branches covered.">		if (!existePunto(c)) {</span>
<span class="fc" id="L155">			boolean aux = false;</span>
<span class="fc" id="L156">			int i = 0;</span>
<span class="fc bfc" id="L157" title="All 4 branches covered.">			while (aux == false &amp;&amp; i &lt; cantPuntos) {</span>
<span class="fc bfc" id="L158" title="All 2 branches covered.">				if (arrPuntos[i] == null) {</span>
<span class="fc" id="L159">					arrPuntos[i] = c;</span>
<span class="fc" id="L160">					aux = true;</span>
<span class="fc" id="L161">					ret.setTipoError(TipoError.OK);</span>
<span class="pc bpc" id="L162" title="1 of 4 branches missed.">				} else if (arrPuntos[i].getCoordX() == c.getCoordX() &amp;&amp; arrPuntos[i].getCoordY() == c.getCoordY()) {</span>
<span class="fc" id="L163">					ret.setTipoError(TipoError.ERROR_2);</span>
<span class="fc" id="L164">					aux = true;</span>
				}
<span class="fc" id="L166">				i++;</span>
			}
<span class="fc bfc" id="L168" title="All 2 branches covered.">			if (aux == false) {</span>
<span class="fc" id="L169">				ret.setTipoError(TipoError.ERROR_1);</span>
			}
		}
		else{
<span class="fc" id="L173">			ret.setTipoError(TipoError.ERROR_3);</span>
		}
<span class="fc" id="L175">		return ret;</span>
	}

	/**
	 * Chequea si existe un punto de nombre p.nombre en el sistema.
	 * 
	 * @param p
	 *            Nuevo punto.
	 * @return false si no existe, true si existe.
	 */
	public boolean existePunto(Punto p) {
<span class="fc" id="L186">		boolean aux = false;</span>
<span class="fc" id="L187">		int i = 0;</span>
<span class="fc bfc" id="L188" title="All 4 branches covered.">		while (i &lt; this.cantPuntos &amp;&amp; aux == false) {</span>
<span class="fc bfc" id="L189" title="All 2 branches covered.">			if (arrPuntos[i] != null) {</span>
<span class="fc bfc" id="L190" title="All 2 branches covered.">				if (arrPuntos[i].getNombre().equals(p.getNombre())) {</span>
<span class="fc" id="L191">					aux = true;</span>
				}
			}
<span class="fc" id="L194">			i++;</span>
		}
<span class="fc" id="L196">		return aux;</span>
	}
	/**
	 * Registra un apiario de nombre nombre en el sistema, el cual está a cargo del apicultor de cédula
	 * cedula_apicultor y tiene una capacidad de producción de capacidad litros de miel por mes.
	 * @param nombre Nombre del apiario.
	 * @param coordX Coordinada del eje X.
	 * @param coordY Coordinada del eje Y.
	 * @param cedula_apicultor Cédula de identidad del apicultor a cargo del apiario.
	 * @param capacidad Capacidad del producción (en litros de miel por mes).
	 * @return Resultado del método.
	 */
	public TipoRetorno registrarApiario(String nombre, double coordX, double coordY, int cedula_apicultor,
			int capacidad){
<span class="fc" id="L210">		TipoRetorno ret = new TipoRetorno();</span>
<span class="fc" id="L211">		ret.setTipoError(TipoError.NO_IMPLEMENTADA); //Retorno por defecto.</span>
<span class="fc" id="L212">		Apicultor a = new Apicultor();</span>
<span class="fc" id="L213">		a.setCedula(cedula_apicultor);</span>
<span class="fc" id="L214">		a = treApicultores.existeApicultor(a, treApicultores.getPrimerNodo());</span>
<span class="fc bfc" id="L215" title="All 2 branches covered.">		if (a != null){</span>
<span class="fc" id="L216">			Apiario api = new Apiario(nombre, coordX, coordY, capacidad, a);</span>
<span class="fc bfc" id="L217" title="All 2 branches covered.">			if (!existePunto(api)) {</span>
<span class="fc" id="L218">				boolean aux = false;</span>
<span class="fc" id="L219">				int i = 0;</span>
<span class="fc bfc" id="L220" title="All 4 branches covered.">				while (aux == false &amp;&amp; i &lt; cantPuntos) {</span>
<span class="fc bfc" id="L221" title="All 2 branches covered.">					if (arrPuntos[i] == null) {</span>
<span class="fc" id="L222">						arrPuntos[i] = api;</span>
<span class="fc" id="L223">						aux = true;</span>
<span class="fc" id="L224">						ret.setTipoError(TipoError.OK);</span>
<span class="pc bpc" id="L225" title="1 of 4 branches missed.">					} else if (arrPuntos[i].getCoordX() == api.getCoordX() &amp;&amp; arrPuntos[i].getCoordY() == api.getCoordY()) {</span>
<span class="fc" id="L226">						ret.setTipoError(TipoError.ERROR_2);</span>
<span class="fc" id="L227">						aux = true;</span>
					}
<span class="fc" id="L229">					i++;</span>
				}
<span class="fc bfc" id="L231" title="All 2 branches covered.">				if (aux == false) {</span>
<span class="fc" id="L232">					ret.setTipoError(TipoError.ERROR_1);</span>
				}
			}
			else{
<span class="fc" id="L236">				ret.setTipoError(TipoError.ERROR_3);</span>
			}
		}
		else{
<span class="fc" id="L240">			ret.setTipoError(TipoError.ERROR_4); //No existe apicultor.</span>
		}
<span class="fc" id="L242">		return ret;</span>
	}
	/**
	 * Registra un centro de extracción de nombre &quot;nombre&quot; en el sistema, con una capacidad de extracción
	 * de &quot;capacidad&quot; litros de miel por mes.
	 * @param nombre Nombre del centro de extracción.
	 * @param coordX Coordenada de ubicación del centro en el eje X.
	 * @param coordY Coordenada de localización del centro en el eje Y.
	 * @param capacidad Capacidad en litros de miel por mes que puede ser extraíada en este centro.
	 * @return Resultado del método.
	 */
	public TipoRetorno registrarCentro(String nombre, double coordX, double coordY, int capacidad){
<span class="fc" id="L254">		TipoRetorno ret = new TipoRetorno();</span>
<span class="fc" id="L255">		ret.setTipoError(TipoError.NO_IMPLEMENTADA); //Retorno por defecto.</span>
<span class="fc" id="L256">		CentroDeExtraccion c = new CentroDeExtraccion(nombre, coordX, coordY, capacidad);</span>
<span class="fc bfc" id="L257" title="All 2 branches covered.">		if (!existePunto(c)) {</span>
<span class="fc" id="L258">			boolean aux = false;</span>
<span class="fc" id="L259">			int i = 0;</span>
<span class="fc bfc" id="L260" title="All 4 branches covered.">			while (aux == false &amp;&amp; i &lt; cantPuntos) {</span>
<span class="fc bfc" id="L261" title="All 2 branches covered.">				if (arrPuntos[i] == null) {</span>
<span class="fc" id="L262">					arrPuntos[i] = c;</span>
<span class="fc" id="L263">					aux = true;</span>
<span class="fc" id="L264">					ret.setTipoError(TipoError.OK);</span>
<span class="pc bpc" id="L265" title="1 of 4 branches missed.">				} else if (arrPuntos[i].getCoordX() == c.getCoordX() &amp;&amp; arrPuntos[i].getCoordY() == c.getCoordY()) {</span>
<span class="fc" id="L266">					ret.setTipoError(TipoError.ERROR_2);</span>
<span class="fc" id="L267">					aux = true;</span>
				}
<span class="fc" id="L269">				i++;</span>
			}
<span class="fc bfc" id="L271" title="All 2 branches covered.">			if (aux == false) {</span>
<span class="fc" id="L272">				ret.setTipoError(TipoError.ERROR_1);</span>
			}
		}
		else{
<span class="fc" id="L276">			ret.setTipoError(TipoError.ERROR_3);</span>
		}
<span class="fc" id="L278">		return ret;</span>
	}
	
	/**
	 * Registra un tramo en el sistema desde la coordenada inicio (coordXi,coordYi) hasta la coordenanda
	 * destino (coordXf,coordYf) de peso &quot;peso&quot;.
	 * @param coordXi Coordenada para el eje X inicial.
	 * @param coordYi Coordenada para el eje Y inicial.
	 * @param coordXf Coordenada para el eje X final.
	 * @param coordYf Coordenada para el eje Y final.
	 * @param peso Kilómetros del tramo.
	 * @return
	 */
	public TipoRetorno registrarTramo(double coordXi, double coordYi, double coordXf, double coordYf, int peso){
<span class="nc" id="L292">		TipoRetorno ret = new TipoRetorno();</span>
<span class="nc" id="L293">		ret.setTipoError(TipoError.NO_IMPLEMENTADA); //Por defecto.</span>
<span class="nc" id="L294">		return ret;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span>JUnitTests (23-nov-2014 18:18:58)</div></body></html>